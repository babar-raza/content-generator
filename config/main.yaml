# Main Configuration - Pipeline and execution order

version: "1.0"

# Agent execution pipeline - order matters!
pipeline:
  - topic_identification
  - kb_ingestion
  - api_ingestion
  - blog_ingestion
  - duplication_check
  - outline_creation
  - introduction_writer
  - section_writer
  - code_generation
  - code_validation
  - conclusion_writer
  - keyword_extraction
  - keyword_injection
  - seo_metadata
  - frontmatter
  - content_assembly
  - link_validation
  - file_writer

# Pipeline variants for different workflows
workflows:
  # Enable LangGraph-based execution (experimental)
  # Set to true to use graph-based execution with automatic checkpointing
  # Set to false to use traditional sequential execution
  use_langgraph: false
  
  # Enable mesh orchestration mode (experimental)
  # Set to true to use dynamic agent-to-agent routing
  # Set to false to use predefined workflows
  use_mesh: false
  
  # Enable parallel execution for independent agents
  # Set to true to execute parallelizable agents concurrently
  enable_parallel_execution: false
  
  # Maximum number of agents that can run in parallel
  # Higher values use more CPU/memory but can reduce total execution time
  # Recommended: 3-5 for most systems, 5-10 for high-end systems
  max_parallel_agents: 5

# Mesh orchestration configuration
mesh:
  enabled: false
  max_hops: 10
  routing_timeout_seconds: 5
  discovery_method: "capability"
  circuit_breaker:
    enabled: true
    failure_threshold: 3
    timeout_seconds: 60

  default:
    name: "Full Blog Post Generation"
    steps:
      - topic_identification
      - kb_ingestion
      - api_ingestion
      - blog_ingestion
      - duplication_check
      - outline_creation
      - introduction_writer
      - section_writer
      - code_generation
      - code_validation
      - conclusion_writer
      - keyword_extraction
      - keyword_injection
      - seo_metadata
      - frontmatter
      - content_assembly
      - link_validation
      - file_writer
  
  code_only:
    name: "Code Generation Only"
    steps:
      - topic_identification
      - api_ingestion
      - code_generation
      - code_validation
      - code_splitting
      - license_injection
      - file_writer
  
  quick_draft:
    name: "Quick Draft (No SEO)"
    steps:
      - topic_identification
      - kb_ingestion
      - outline_creation
      - section_writer
      - conclusion_writer
      - content_assembly
      - file_writer

# Agent dependencies (enforced at runtime)
dependencies:
  outline_creation:
    requires:
      - topic_identification
      - kb_ingestion
  
  section_writer:
    requires:
      - outline_creation
  
  code_generation:
    requires:
      - api_ingestion
  
  content_assembly:
    requires:
      - section_writer
      - conclusion_writer
  
  file_writer:
    requires:
      - content_assembly

# MCP Traffic Monitoring
mcp:
  traffic_retention_days: 7
  traffic_logging_enabled: true

# Job Management Configuration
jobs:
  # Maximum number of retry attempts for failed jobs
  max_retries: 3
  
  # Retry delay in seconds (exponential backoff will be applied)
  retry_delay_seconds: 60
  
  # Maximum concurrent jobs
  max_concurrent_jobs: 3
  
  # Job storage configuration
  storage:
    base_dir: ".jobs"
    archive_dir: ".jobs/archive"
  
  # Archive configuration
  archive:
    # Enable automatic archiving of completed/failed jobs
    auto_archive_enabled: true
    
    # Days to wait before auto-archiving completed jobs
    auto_archive_completed_after_days: 7
    
    # Days to wait before auto-archiving failed jobs
    auto_archive_failed_after_days: 14
    
    # Days to keep archived jobs before deletion
    retention_days: 30
    
    # Enable automatic cleanup of old archives
    auto_cleanup_enabled: true
